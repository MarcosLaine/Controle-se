import{j as e}from"./chart-vendor-Bh8T1N6h.js";import{r as n}from"./react-vendor-Ds2lu_e3.js";import{u as C,b as m,z as t,T as v}from"./index-Bxg-l_Jj.js";import{M as w}from"./Modal-CbvRRIwR.js";import{P as E,T as S}from"./trash-2-CF_gXZbT.js";import{P as k}from"./pen-square-avoyjI0f.js";function O(){const{user:r}=C(),[g,p]=n.useState([]),[f,x]=n.useState(!0),[j,u]=n.useState(!1),[o,h]=n.useState(null),[s,l]=n.useState({nome:"",budget:""});n.useEffect(()=>{c()},[r]);const c=async()=>{if(r){x(!0);try{const a=await m.get(`/categories?userId=${r.id}`);a.success&&p(a.data||[])}catch{t.error("Erro ao carregar categorias")}finally{x(!1)}}},b=async a=>{if(a.preventDefault(),!s.nome.trim()){t.error("Nome da categoria é obrigatório");return}try{o?(await m.put(`/categories/${o.idCategoria}`,{nome:s.nome,userId:r.id})).success&&(t.success("Categoria atualizada!"),c(),d()):(await m.post("/categories",{nome:s.nome,userId:r.id,budget:s.budget?parseFloat(s.budget):null})).success&&(t.success("Categoria criada!"),c(),d())}catch(i){t.error(i.message||"Erro ao salvar categoria")}},N=a=>{h(a),l({nome:a.nome,budget:""}),u(!0)},y=async a=>{if(confirm("Tem certeza que deseja excluir esta categoria?"))try{(await m.delete(`/categories/${a}?userId=${r.id}`)).success&&(t.success("Categoria excluída!"),c())}catch(i){t.error(i.message||"Erro ao excluir categoria")}},d=()=>{u(!1),h(null),l({nome:"",budget:""})};return f?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-primary-600 border-t-transparent"})}):e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Categorias"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Organize suas transações por categorias"})]}),e.jsxs("button",{onClick:()=>u(!0),className:"btn-primary",children:[e.jsx(E,{className:"w-4 h-4"}),"Nova Categoria"]})]}),g.length===0?e.jsxs("div",{className:"card text-center py-12",children:[e.jsx(v,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Nenhuma categoria cadastrada"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map(a=>e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:a.nome})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>N(a),className:"btn-secondary flex-1",children:[e.jsx(k,{className:"w-4 h-4"}),"Editar"]}),e.jsxs("button",{onClick:()=>y(a.idCategoria),className:"btn-danger flex-1",children:[e.jsx(S,{className:"w-4 h-4"}),"Excluir"]})]})]},a.idCategoria))}),e.jsx(w,{isOpen:j,onClose:d,title:o?"Editar Categoria":"Nova Categoria",children:e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Nome da Categoria"}),e.jsx("input",{type:"text",value:s.nome,onChange:a=>l({...s,nome:a.target.value}),className:"input",placeholder:"Ex: Alimentação, Transporte...",required:!0})]}),!o&&e.jsxs("div",{children:[e.jsx("label",{className:"label",children:"Orçamento Mensal (Opcional)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"R$"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:s.budget,onChange:a=>l({...s,budget:a.target.value}),className:"input pl-10",placeholder:"0,00"})]})]}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx("button",{type:"button",onClick:d,className:"btn-secondary",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn-primary",children:o?"Atualizar":"Criar"})]})]})})]})}export{O as default};
