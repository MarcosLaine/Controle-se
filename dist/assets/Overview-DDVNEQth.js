import{j as e,D as O,C as L,A as B,p as T,a as D,b as G,L as M,B as _,c as K}from"./chart-vendor-Bh8T1N6h.js";import{r as t}from"./react-vendor-Ds2lu_e3.js";import{c as W,u as z,a as U,b as w}from"./index-D8iPbbyk.js";import{f as o,a as V}from"./formatters-Dsd9xoBe.js";import{S as d}from"./SummaryCard-CVxJGsjw.js";import{M as S}from"./Modal-sr4I0w_v.js";import{A as C,a as I}from"./arrow-up-D6-4z40S.js";import{S as q}from"./scale-sdIhPVkq.js";import{I as P}from"./info-Bm7fsZxw.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=W("Landmark",[["line",{x1:"3",x2:"21",y1:"22",y2:"22",key:"j8o0r"}],["line",{x1:"6",x2:"6",y1:"18",y2:"11",key:"10tf0k"}],["line",{x1:"10",x2:"10",y1:"18",y2:"11",key:"54lgf6"}],["line",{x1:"14",x2:"14",y1:"18",y2:"11",key:"380y"}],["line",{x1:"18",x2:"18",y1:"18",y2:"11",key:"1kevvc"}],["polygon",{points:"12 2 20 7 4 7",key:"jkujk7"}]]);L.register(B,T,D,G,M,_,K);function te(){const{user:r}=z(),{fetchData:m,getCachedData:x}=U(),[E,u]=t.useState(!1),[p,$]=t.useState("month"),[a,h]=t.useState(null),[g,y]=t.useState([]),[A,f]=t.useState(!1),[R,j]=t.useState(!1);t.useEffect(()=>{if(!r)return;(async()=>{const i=`overview-${r.id}-${p}`,l=`recent-transactions-${r.id}`,v=x(i),N=x(l);if(v&&N){h(v),y(N);return}u(!0);try{const[c,k]=await Promise.all([m(i,async()=>{const n=await w.get(`/dashboard/overview?userId=${r.id}`);return n.success?n.data:null}),m(l,async()=>{const n=await w.get(`/transactions/recent?userId=${r.id}`);return n.success?n.data||[]:[]})]);c&&h(c),k&&y(k)}catch(c){console.error("Erro ao carregar dados:",c)}finally{u(!1)}})()},[r,p,m,x]);const b=a!=null&&a.categoryBreakdown?{labels:a.categoryBreakdown.map(s=>s.name),datasets:[{data:a.categoryBreakdown.map(s=>s.value),backgroundColor:["#ef4444","#f59e0b","#3b82f6","#8b5cf6","#ec4899","#14b8a6","#f97316","#6366f1"],borderWidth:2,borderColor:"#fff"}]}:null;return E?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-primary-600 border-t-transparent"})}):e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Visão Geral"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Resumo das suas finanças"})]}),e.jsxs("select",{value:p,onChange:s=>$(s.target.value),className:"input w-auto",children:[e.jsx("option",{value:"month",children:"Este Mês"}),e.jsx("option",{value:"year",children:"Este Ano"}),e.jsx("option",{value:"all",children:"Todos os Períodos"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(d,{title:"Receitas",amount:o((a==null?void 0:a.totalIncome)||0),icon:C,type:"income"}),e.jsx(d,{title:"Gastos",amount:o((a==null?void 0:a.totalExpense)||0),icon:I,type:"expense"}),e.jsx(d,{title:e.jsxs("span",{className:"flex items-center gap-2",children:["Saldo",e.jsx(P,{className:"w-4 h-4 cursor-pointer opacity-70 hover:opacity-100",onClick:s=>{s.stopPropagation(),f(!0)}})]}),amount:o((a==null?void 0:a.balance)||0),icon:q,type:"balance"}),e.jsx(d,{title:e.jsxs("span",{className:"flex items-center gap-2",children:["Patrimônio",e.jsx(P,{className:"w-4 h-4 cursor-pointer opacity-70 hover:opacity-100",onClick:s=>{s.stopPropagation(),j(!0)}})]}),amount:o((a==null?void 0:a.netWorth)||0),icon:F,type:"default"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Gastos por Categoria"}),b?e.jsx("div",{className:"h-64",children:e.jsx(O,{data:b,options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,usePointStyle:!0,color:"#6b7280"}},tooltip:{callbacks:{label:s=>{const i=s.label||"",l=o(s.parsed);return`${i}: ${l}`}}}}}})}):e.jsx("p",{className:"text-center text-gray-500 py-8",children:"Nenhum dado disponível"})]}),e.jsxs("div",{className:"card",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-4",children:"Transações Recentes"}),e.jsx("div",{className:"space-y-3 max-h-64 overflow-y-auto",children:g.length>0?g.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${s.type==="income"?"bg-green-100 dark:bg-green-900/30 text-green-600":"bg-red-100 dark:bg-red-900/30 text-red-600"}`,children:s.type==="income"?e.jsx(C,{className:"w-5 h-5"}):e.jsx(I,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900 dark:text-white",children:s.description||"Sem descrição"}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:V(s.date)})]})]}),e.jsxs("div",{className:`font-semibold ${s.type==="income"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}`,children:[s.type==="income"?"+":"-",o(s.value||0)]})]},s.id)):e.jsx("p",{className:"text-center text-gray-500 py-8",children:"Nenhuma transação recente"})})]})]}),e.jsx(S,{isOpen:A,onClose:()=>f(!1),title:"Informação: Saldo",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:["O ",e.jsx("strong",{children:"Saldo"})," representa a soma de todas as suas contas disponíveis para uso imediato (Corrente, Poupança, Dinheiro, etc.)."]}),e.jsxs("p",{children:["Contas do tipo ",e.jsx("strong",{children:"Investimento"})," não são contabilizadas neste valor."]})]})}),e.jsx(S,{isOpen:R,onClose:()=>j(!1),title:"Informação: Patrimônio",children:e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{children:["O ",e.jsx("strong",{children:"Patrimônio"})," representa o valor total acumulado em todas as suas contas cadastradas no sistema."]}),e.jsxs("p",{children:["Este valor inclui o saldo de todas as contas, inclusive as de"," ",e.jsx("strong",{children:"Investimento"}),"."]})]})})]})}export{te as default};
